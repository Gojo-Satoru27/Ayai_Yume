_G.AutoCollectFruits = true   -- B·∫≠t/t·∫Øt Auto nh·∫∑t tr√°i
_G.AutoServerHop = true       -- B·∫≠t/t·∫Øt Auto ƒë·ªïi server n·∫øu kh√¥ng c√≥ tr√°i

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local fruitsCollected = 0
local startTime = os.time()

---------------------------------------------------
-- üñ•Ô∏è T·∫†O GUI GIAO DI·ªÜN
---------------------------------------------------
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AutoFruitMenu"
screenGui.Parent = player:WaitForChild("PlayerGui")

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 280, 0, 120)
mainFrame.Position = UDim2.new(0.5, -140, 0.1, 0)
mainFrame.BackgroundTransparency = 0.4
mainFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
mainFrame.Parent = screenGui

local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(1, 0, 0.2, 0)
titleLabel.BackgroundTransparency = 1
titleLabel.TextColor3 = Color3.new(1, 1, 1)
titleLabel.Font = Enum.Font.SourceSansBold
titleLabel.TextScaled = true
titleLabel.Text = "Auto Fruit - Blox Fruits"
titleLabel.Parent = mainFrame

local timeLabel = Instance.new("TextLabel")
timeLabel.Size = UDim2.new(1, 0, 0.2, 0)
timeLabel.Position = UDim2.new(0, 0, 0.2, 0)
timeLabel.BackgroundTransparency = 1
timeLabel.TextColor3 = Color3.new(1, 1, 1)
timeLabel.Font = Enum.Font.SourceSans
timeLabel.TextScaled = true
timeLabel.Text = "Time: 0s"
timeLabel.Parent = mainFrame

local statusLabel = Instance.new("TextLabel")
statusLabel.Size = UDim2.new(1, 0, 0.2, 0)
statusLabel.Position = UDim2.new(0, 0, 0.4, 0)
statusLabel.BackgroundTransparency = 1
statusLabel.TextColor3 = Color3.new(1, 1, 1)
statusLabel.Font = Enum.Font.SourceSans
statusLabel.TextScaled = true
statusLabel.Text = "T√¨m tr√°i..."
statusLabel.Parent = mainFrame

local discordButton = Instance.new("TextButton")
discordButton.Size = UDim2.new(1, 0, 0.2, 0)
discordButton.Position = UDim2.new(0, 0, 0.6, 0)
discordButton.BackgroundTransparency = 0.2
discordButton.BackgroundColor3 = Color3.fromRGB(30, 144, 255)
discordButton.TextColor3 = Color3.new(1, 1, 1)
discordButton.Font = Enum.Font.SourceSansBold
discordButton.TextScaled = true
discordButton.Text = "Join Discord"
discordButton.Parent = mainFrame
discordButton.MouseButton1Click:Connect(function()
    setclipboard("https://discord.gg/3Tp35BhYeG")
    statusLabel.Text = "Link ƒë√£ sao ch√©p!"
end)

-- C·∫≠p nh·∫≠t th·ªùi gian ch·∫°y m·ªói gi√¢y
spawn(function()
    while _G.AutoCollectFruits do
        local elapsed = os.time() - startTime
        timeLabel.Text = "Time: " .. elapsed .. "s"
        wait(1)
    end
end)

---------------------------------------------------
-- üîç T√åM TR√ÅI √ÅC QU·ª∂ G·∫¶N NH·∫§T
---------------------------------------------------
local function FindNearestFruit()
    local nearestFruit, nearestDistance = nil, math.huge
    if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then return nil end
    local hrp = player.Character.HumanoidRootPart
    for _, fruit in pairs(game.Workspace:GetChildren()) do
        if fruit:IsA("Model") and fruit:FindFirstChild("Handle") and string.find(fruit.Name, "Fruit") then
            local distance = (hrp.Position - fruit.Handle.Position).Magnitude
            if distance < nearestDistance then
                nearestFruit, nearestDistance = fruit, distance
            end
        end
    end
    return nearestFruit
end

---------------------------------------------------
-- ‚ö° TELEPORT SI√äU NHANH (ANTI-KICK)
---------------------------------------------------
local function TeleportToFruit(fruit)
    if not fruit or not fruit:FindFirstChild("Handle") then return end
    if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then return end
    local hrp = player.Character.HumanoidRootPart
    local targetPos = fruit.Handle.Position

    local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Linear)
    local tween = TweenService:Create(hrp, tweenInfo, {CFrame = CFrame.new(targetPos)})
    tween:Play()

    wait(0.5) -- Ch·ªù ƒë·ªÉ nh·∫∑t
    local prompt = fruit.Handle:FindFirstChildWhichIsA("ProximityPrompt")
    if prompt then
        fireproximityprompt(prompt)
        statusLabel.Text = "Nh·∫∑t th√†nh c√¥ng: " .. fruit.Name
    else
        statusLabel.Text = "Kh√¥ng t√¨m th·∫•y prompt!"
    end
end

---------------------------------------------------
-- üì¶ L∆ØU TR√ÅI V√ÄO KHO
---------------------------------------------------
local function StoreFruit()
    local fruitTool = player.Backpack:FindFirstChildWhichIsA("Tool")
    if fruitTool then
        local args = {"StoreFruit", fruitTool}
        ReplicatedStorage.Remotes.CommF_:InvokeServer(unpack(args))
        statusLabel.Text = "ƒê√£ l∆∞u v√†o kho: " .. fruitTool.Name
    end
end

---------------------------------------------------
-- üîÑ ƒê·ªîI SERVER N·∫æU KH√îNG C√ì TR√ÅI
---------------------------------------------------
local function ServerHop()
    local url = "https://games.roblox.com/v1/games/2753915549/servers/Public?sortOrder=Asc&limit=100"
    local servers = HttpService:JSONDecode(game:HttpGet(url)).data
    for _, server in pairs(servers) do
        if server.playing < server.maxPlayers and server.id ~= game.JobId then
            statusLabel.Text = "ƒêang ƒë·ªïi server..."
            TeleportService:TeleportToPlaceInstance(game.PlaceId, server.id, player)
            break
        end
    end
end

---------------------------------------------------
-- üîÑ AUTO NH·∫∂T TR√ÅI
---------------------------------------------------
while _G.AutoCollectFruits do
    local fruit = FindNearestFruit()
    if fruit then
        TeleportToFruit(fruit)
        fruitsCollected = fruitsCollected + 1
        StoreFruit()
    else
        statusLabel.Text = "Kh√¥ng t√¨m th·∫•y tr√°i!"
        if _G.AutoServerHop then
            ServerHop()
        end
    end
    wait(5) -- Ki·ªÉm tra l·∫°i m·ªói 5 gi√¢y
end
