local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")

local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

local AutoAimEnabled = false -- Trạng thái bật/tắt
local ImageID = "https://www.roblox.com/asset/?id=111982589088426" -- ID hình ảnh

-- Tạo GUI hiển thị trạng thái Auto Aim
local ScreenGui = Instance.new("ScreenGui", CoreGui)

local BackgroundImage = Instance.new("ImageLabel", ScreenGui)
BackgroundImage.Size = UDim2.new(0, 200, 0, 50) -- Kích thước
BackgroundImage.Position = UDim2.new(0.5, -100, 0.05, 0) -- Giữa màn hình
BackgroundImage.Image = ImageID
BackgroundImage.BackgroundTransparency = 1 -- Không có nền đen
BackgroundImage.Visible = false

local StatusText = Instance.new("TextLabel", BackgroundImage)
StatusText.Size = UDim2.new(1, 0, 1, 0)
StatusText.Position = UDim2.new(0, 0, 0, 0)
StatusText.BackgroundTransparency = 1
StatusText.TextScaled = true
StatusText.TextColor3 = Color3.fromRGB(255, 255, 255) -- Chữ màu trắng
StatusText.Font = Enum.Font.SourceSansBold
StatusText.Text = "Ayai_Yume OFF"

-- Hàm lấy kẻ địch gần nhất
function getClosestPlayer()
    local closestPlayer = nil
    local shortestDistance = math.huge

    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local pos = player.Character.HumanoidRootPart.Position
            local distance = (LocalPlayer.Character.HumanoidRootPart.Position - pos).magnitude

            if distance < shortestDistance then
                closestPlayer = player
                shortestDistance = distance
            end
        end
    end
    return closestPlayer
end

-- Điều chỉnh tâm nhắm khi bật Auto Aim
RunService.RenderStepped:Connect(function()
    if AutoAimEnabled then
        local target = getClosestPlayer()
        if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
            Mouse.Hit = target.Character.HumanoidRootPart.CFrame
        end
    end
end)

-- Bật/Tắt Auto Aim khi nhấn phím "V"
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if input.KeyCode == Enum.KeyCode.V and not gameProcessed then
        AutoAimEnabled = not AutoAimEnabled
        BackgroundImage.Visible = true -- Hiện UI

        if AutoAimEnabled then
            StatusText.Text = "Ayai_Yume ON"
            StatusText.TextColor3 = Color3.fromRGB(0, 255, 0) -- Màu xanh khi bật
        else
            StatusText.Text = "Ayai_Yume OFF"
            StatusText.TextColor3 = Color3.fromRGB(255, 0, 0) -- Màu đỏ khi tắt
        end
    end
end)
