-- Dịch vụ Roblox
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

-- Biến chính
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera
local AutoAimEnabled = false

-- GUI hiển thị trạng thái Auto Aim
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = LocalPlayer:FindFirstChildOfClass("PlayerGui")

local StatusFrame = Instance.new("Frame", ScreenGui)
StatusFrame.Size = UDim2.new(0, 200, 0, 50)
StatusFrame.Position = UDim2.new(0.5, -100, 0.05, 0)
StatusFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
StatusFrame.BorderSizePixel = 2
StatusFrame.BorderColor3 = Color3.fromRGB(255, 255, 255)

local StatusText = Instance.new("TextLabel", StatusFrame)
StatusText.Size = UDim2.new(1, 0, 1, 0)
StatusText.BackgroundTransparency = 1
StatusText.TextScaled = true
StatusText.TextColor3 = Color3.fromRGB(255, 0, 0) -- Mặc định là đỏ (OFF)
StatusText.Font = Enum.Font.SourceSansBold
StatusText.Text = "Auto Aim OFF"

-- Hàm lấy kẻ địch gần nhất
function getClosestPlayer()
    local closestPlayer = nil
    local shortestDistance = math.huge

    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local pos = player.Character.HumanoidRootPart.Position
            local distance = (LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") and 
                (LocalPlayer.Character.HumanoidRootPart.Position - pos).magnitude) or math.huge

            if distance < shortestDistance then
                closestPlayer = player
                shortestDistance = distance
            end
        end
    end
    return closestPlayer
end

-- Hàm Auto Aim (chỉ hoạt động khi bật ON)
RunService.RenderStepped:Connect(function()
    if AutoAimEnabled then
        local target = getClosestPlayer()
        if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
            local screenPoint, onScreen = Camera:WorldToViewportPoint(target.Character.HumanoidRootPart.Position)
            if onScreen then
                mousemoverel((screenPoint.X - Camera.ViewportSize.X / 2) * 0.1, (screenPoint.Y - Camera.ViewportSize.Y / 2) * 0.1)
            end
        end
    end
end)

-- Bật/Tắt Auto Aim khi nhấn phím "V"
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if input.KeyCode == Enum.KeyCode.V and not gameProcessed then
        AutoAimEnabled = not AutoAimEnabled
        if AutoAimEnabled then
            StatusText.Text = "Auto Aim ON"
            StatusText.TextColor3 = Color3.fromRGB(0, 255, 0) -- Xanh khi bật
        else
            StatusText.Text = "Auto Aim OFF"
            StatusText.TextColor3 = Color3.fromRGB(255, 0, 0) -- Đỏ khi tắt
        end
    end
end)
