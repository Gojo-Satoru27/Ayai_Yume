-- Dịch vụ Roblox
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

-- Biến chính
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera
local AutoAimEnabled = false

-- Tạo GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = LocalPlayer:FindFirstChildOfClass("PlayerGui")

local StatusFrame = Instance.new("TextButton", ScreenGui) -- Đổi từ Frame thành TextButton
StatusFrame.Size = UDim2.new(0, 200, 0, 50)
StatusFrame.Position = UDim2.new(0.5, -100, 0.05, 0)
StatusFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
StatusFrame.BorderSizePixel = 2
StatusFrame.BorderColor3 = Color3.fromRGB(255, 255, 255)
StatusFrame.TextScaled = true
StatusFrame.Font = Enum.Font.SourceSansBold
StatusFrame.TextColor3 = Color3.fromRGB(255, 0, 0) -- Mặc định là đỏ (OFF)
StatusFrame.Text = "Auto Aim OFF"

-- Hàm lấy kẻ địch gần nhất
function getClosestPlayer()
    local closestPlayer = nil
    local shortestDistance = math.huge

    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local pos = player.Character.HumanoidRootPart.Position
            local distance = (LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") and 
                (LocalPlayer.Character.HumanoidRootPart.Position - pos).magnitude) or math.huge

            if distance < shortestDistance then
                closestPlayer = player
                shortestDistance = distance
            end
        end
    end
    return closestPlayer
end

-- Hàm Auto Aim (chỉ hoạt động khi bật ON)
RunService.RenderStepped:Connect(function()
    if AutoAimEnabled then
        local target = getClosestPlayer()
        if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
            local screenPoint, onScreen = Camera:WorldToViewportPoint(target.Character.HumanoidRootPart.Position)
            if onScreen then
                mousemoverel((screenPoint.X - Camera.ViewportSize.X / 2) * 0.1, (screenPoint.Y - Camera.ViewportSize.Y / 2) * 0.1)
            end
        end
    end
end)

-- Chuyển đổi Auto Aim khi nhấn vào nút
StatusFrame.MouseButton1Click:Connect(function()
    AutoAimEnabled = not AutoAimEnabled
    if AutoAimEnabled then
        StatusFrame.Text = "Auto Aim ON"
        StatusFrame.TextColor3 = Color3.fromRGB(0, 255, 0) -- Xanh khi bật
    else
        StatusFrame.Text = "Auto Aim OFF"
        StatusFrame.TextColor3 = Color3.fromRGB(255, 0, 0) -- Đỏ khi tắt
    end
end)
